---
title: "Visualizando FICs Colombia"
format: 
    html:
        toc: true
        toc-location: left
        toc-title: Contenido
        theme: materia
        grid:
            sidebar-width: 300px
            body-width: 1100px
            margin-width: 300px
            gutter-width: 2rem
editor: visual
---

```{css, echo = FALSE}
p {
  text-align: justify
}
```

## Introducción

En este documento, mostraré como visualizar los datos de los Fondos de Inversión Colectiva (FICs) proporcionados por la Superintendencia Financiera de Colombia (SFC), usando herramientas de Business Intelligence (BI) como R y PowerBI con el objetivo de hacer más fácil el análisis de los mismos.

En caso de que no sepas que es un Fondos de Inversión Colectiva a continuación te dejo este vídeo de Youtube de Karem Suarez donde hace una breve explicación de este tipo de inversiones.

{{< video https://youtu.be/OP-qQxDomE0 >}}

## Problemática

Al momento de crear este documento existen alrededor de 240 FICs activos, ofrecidos por 30 compañías, esto hace que una persona que quiera invertir en uno de estos fondos tenga que realizar una investigación ardua entrando a algunas paginas de estas compañías o contactando a asesores financieros de las mismas para poder hacerse a una idea de que fondos se ajustan a sus requerimientos de rentabilidad y riesgo, y aun así no podrá tener una visión completa de las alternativas que tiene disponibles.

Para poder tener un lugar centralizado donde el publico pueda ver información básica de los fondos la SFC pone a disposición el **Reporte de Rentabilidades de los Fondos de Inversión Colectiva** donde se muestra el histórico de número de inversionistas, valor del fondo, valor de la unidad y rentabilidad, para que podamos tener mejores criterios al escoger un fondo para invertir. Desafortunadamente la forma de presentación de este reporte es por medio de una tabla la cual no es amigable de manipular como lo comentan desde el canal ACORRINVERSIONES en una sección de su canal de Youtube:

{{< video https://youtu.be/bI3mZXxhYWI start="81" >}}

## Objetivo

Mi propósito es tomar los datos de FICs publicados por la SFC y crear visualizaciones y tablas amigables que ayuden a los interesados en los fondos en obtener insights de la situación de los mismos usando una interfaz cenicilla donde se muestren los principales indicadores de los mismos.

Nuestro resultado Final es el siguiente tablero de PowerBI

<iframe title="Sample Report Demo" width="1140" height="541.25" src="https://playground.powerbi.com/sampleReportEmbed" frameborder="0" allowFullScreen="true">

</iframe>

## Obtención de datos

Los datos históricos de los FICs los podemos encontrar en la pagina de la SFC en el siguiente [enlace](https://www.superfinanciera.gov.co/publicaciones/10086357/informes-y-cifrascifrasportafolios-de-inversionreporte-de-las-rentabilidades-de-fondos-de-inversion-colectiva-10086357/ "Reporte de las rentabilidades de Fondos de Inversión Colectiva"){target="_blank"} donde se puede seleccionar por entidad o periodo de tiempo así como descargarlos en formato Excel. Una segunda opción es el portal de datos abiertos del gobierno colombiano en el siguiente [enlace](https://www.datos.gov.co/Hacienda-y-Cr-dito-P-blico/Rentabilidades-de-los-Fondos-de-Inversi-n-Colectiv/qhpu-8ixx/about_data "Rentabilidades de los Fondos de Inversión Colectiva (FIC)"){target="_blank"} donde adicionalmente podemos encontrar un API para acceder a los datos. Tomaremos la segunda opción ya que podemos interactuar con el API mediante R, con el que posteriormente también realizaremos la limpieza de datos.

Este API es administrado por SOCRATA quien usa para las consultas el lenguaje `SoQL` el cual es similar a SQL facilitando su construcción. La documentación para este conunto de datos la podemos encontrar en el siguiente [enlace](https://dev.socrata.com/foundry/www.datos.gov.co/qhpu-8ixx "Doc: Rentabilidades de los Fondos de Inversión Colectiva (FIC)"){target="_blank"}.

Empezamos cargando los paquetes y parámetros que vamos a utilizar.

```{r warning=FALSE, message=FALSE}

options(scipen = 999)

library(tidyverse)
library(lubridate)
library(jsonlite)
library(timetk)
library(knitr)
```

Miremos un ejemplo de la repuesta de una consulta al conjunto de datos

```{r warning=FALSE, message=FALSE}

str_glue("https://www.datos.gov.co/resource/qhpu-8ixx.json?$LIMIT=1") %>% 
        URLencode() %>% 
    fromJSON() %>% 
    kable()

```
